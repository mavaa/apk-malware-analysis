import csv
import os

permissions = [
    "ACCESS_COARSE_DATA",
    "ACCESS_COARSE_LOCATION",
    "ACCESS_FINE_LOCATION",
    "ACCESS_MOCK_LOCATION",
    "BATTERY_STATS",
    "BLUETOOTH",
    "BLUETOOTH_ADMIN",
    "CALL_PHONE",
    "CAMERA",
    "CHANGE_WIFI_STATE",
    "DISABLE_KEYGUARD",
    "GET_TASKS",
    "INTERNET",
    "MANAGE_ACCOUNTS",
    "NFC",
    "PROCESS_OUTGOING_CALLS",
    "READ_CALENDAR",
    "READ_CONTACTS",
    "READ_EXTERNAL_STORAGE",
    "READ_HISTORY_BOOKMARKS",
    "READ_PHONE_STATE",
    "READ_SMS",
    "RECEIVE_SMS",
    "RECORD_AUDIO",
    "SEND_SMS",
    "SYSTEM_ALERT_WINDOW",
    "WRITE_CONTACTS",
    "WRITE_EXTERNAL_STORAGE",
    "WRITE_HISTORY_BOOKMARKS",
    "WRITE_SMS",
]

def add_csv_line(app_path, extracted_path, csv_path, app_permissions, num_ips):
    csv_line = []

    file = open(csv_path, "a", newline="")
    csv_out = csv.writer(file, delimiter=",", quotechar="|", quoting=csv.QUOTE_MINIMAL)

    # Permissions
    for permission in permissions:
        csv_line.append(1 if permission in app_permissions else 0)

    # Num permissions
    csv_line.append(len(app_permissions))

    # Number of ips found
    csv_line.append(num_ips)

    # TODO: Fix domains found
    csv_line.append(0)

    # TODO: Fix contained files
    csv_line.append(0)

    # TODO: Fix country code
    csv_line.append(0)

    # File size bytes
    csv_line.append(os.path.getsize(app_path))

    # TODO: Fix build year
    csv_line.append(0)

    # TODO: Fix app sha256
    csv_line.append(0)

    # TODO: Fix malware target
    csv_line.append(0)

    # TODO: Fix malware family
    csv_line.append(0)

    csv_out.writerow(csv_line)
