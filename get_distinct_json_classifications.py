import json
import os

distinct_classifications = {}
jsondir = '100_random_jsons/'

# distinct_classifications["test"] = ["a", "b", "c"]

for json_filename in os.listdir(jsondir):
    js_data = json.load(open(jsondir + json_filename, "r"))
    analysis_data = js_data["data"]["attributes"]["last_analysis_results"]

    for key in analysis_data:
        category = analysis_data[key]["category"]
        result = analysis_data[key]["result"]
        if category == "malicious":
            if not key in distinct_classifications:
                distinct_classifications[key] = []

            distinct_classifications[key].append(result)

# Remove dupes
for key in distinct_classifications:
    distinct_classifications[key] = list(dict.fromkeys(distinct_classifications[key]))


out_file = open("distinct.json", "w")
out_file.write(json.dumps(distinct_classifications, sort_keys=True, indent=4))
out_file.close()
