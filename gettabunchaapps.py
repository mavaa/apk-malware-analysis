import vtapi.vtapi as vtapi
import apktool.extractor as extractor
import generator.generator as generator
import androzoo.androzoo as androzoo
import sqlite3

apikey_androzoo =open("androzoo/apikey.txt").read().strip()
app_table = "random_malware.sqlite"

# Create table
androzoo.create_app_table(app_table)

# Get apps for the table
apps = androzoo.get_random_apps("androzoo/androzoo.sqlite", "m", 26);

con = sqlite3.Connection(app_table)
cur = con.cursor()

for app in apps:
    cur.execute('INSERT INTO apps VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)', app)

cur.close()
con.commit()
con.close()

# Download apps
con = sqlite3.Connection(app_table)
cur = con.cursor()

dl_apps = cur.execute("SELECT * FROM apps;").fetchall()

androzoo.download_apps(dl_apps, apikey_androzoo, "26_random_malapps")
