import csv
import os
import pandas as pd
import generator.generator as generator

# Number of apps in each category to get
num_apps_to_get = 6

# Drop rows with "no tag" as label
def drop_no_tag(df):
    return df.drop(df[df.malware_FAMILY == "no tag"].index)

# Get malware apps
df_malware = drop_no_tag(pd.read_csv("app_data/apps_complete_malware.csv"))

final_apps = pd.DataFrame(columns = df_malware.columns)

labels = df_malware.malware_FAMILY.unique()

for label in labels:
    labeled_apps = df_malware[df_malware.malware_FAMILY == label]
    if len(labeled_apps) >= num_apps_to_get:
        final_apps = final_apps.append(labeled_apps.sample(num_apps_to_get), ignore_index=True)

final_apps_all = df_malware.sample(len(df_malware))

# Get clean apps
df_clean = drop_no_tag(pd.read_csv("app_data/apps_complete_clean.csv"))

final_apps = final_apps.append(df_clean.sample(num_apps_to_get), ignore_index=True)

final_apps_all = final_apps_all.append(df_clean.sample(len(df_clean)), ignore_index=True)

# Randomize the order of the apps
final_apps = final_apps.sample(len(final_apps))
final_apps_all = final_apps_all.sample(len(final_apps_all))


# Write to file
final_apps.to_csv("app_data/training_set.csv", index=False)
final_apps_all.to_csv("app_data/training_set_all.csv", index=False)
