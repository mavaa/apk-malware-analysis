import requests
import time
import os

# Load API key
api_path = os.path.join(
        os.path.dirname(
            os.path.abspath(__file__)), "vtapi.txt")
apikey = open(api_path).read().strip()

def get_vt_info(sha256sum):

    response = requests.get("https://www.virustotal.com/api/v3/files/" + sha256sum, headers = {"x-apikey" : apikey});

    while True:
        if response.status_code == 200:
            # return response.json() # Return content deserialized to a dictionary
            return response.content # Return raw content bytes
        elif response.status_code == 429:
            print("Quota exeeded, waiting 15 secs")
            time.sleep(15)
        else:
            raise ApiError(response)

class ApiError(Exception):
    pass
